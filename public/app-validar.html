<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Valida√ß√£o por QR Code - Cart√£o AproveitAI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family: Arial, Helvetica, sans-serif;
  background:#eaf7ef;
}

/* ===== HEADER ===== */
header{
  background:#fff;
  border-bottom:1px solid #ddd;
}
.header-wrap{
  max-width:1200px;
  margin:auto;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:15px;
}
.header-left img{ height:70px; }
.header-center{
  text-align:center;
  flex:1;
}
.header-center h1{
  margin:0;
  color:#0a7a2a;
}
.header-center p{
  margin:5px 0 0;
  font-size:14px;
  color:#555;
}
.header-right img{ height:55px; }

.subheader{
  background:#dbffe1;
  padding:12px;
  text-align:center;
  font-weight:bold;
}

/* ===== MAIN ===== */
main{
  background:#9fe3ff;
  padding:40px 15px;
}
.card{
  background:#fff;
  max-width:720px;
  margin:auto;
  padding:35px;
  border-radius:14px;
  box-shadow:0 6px 20px rgba(0,0,0,0.15);
  text-align:center;
}

.btn{
  background:#1a8a4a;
  color:#fff;
  border:none;
  padding:16px 26px;
  font-size:18px;
  border-radius:10px;
  cursor:pointer;
}
.btn:hover{ opacity:0.9 }

.btn-camera{
  background:#0a7a2a;
  font-size:20px;
  margin-bottom:25px;
  width:100%;
}

.inputs{
  display:flex;
  gap:12px;
  justify-content:center;
  flex-wrap:wrap;
  margin-top:20px;
}
.inputs input{
  width:280px;
  padding:15px;
  font-size:17px;
  border-radius:8px;
  border:1px solid #999;
}

#resultado{
  margin-top:30px;
  padding:18px;
  border-radius:10px;
  display:none;
  font-size:18px;
}

/* ===== FOOTER ===== */
footer{
  background:#dbffe1;
  text-align:center;
  padding:15px;
  font-size:13px;
}
</style>
</head>

<body>

<!-- ===== HEADER ===== -->
<header>
  <div class="header-wrap">
    <div class="header-left">
      <img src="logo-prometheus.png">
    </div>
    <div class="header-center">
      <h1>Cart√£o AproveitAI</h1>
      <p>Tecnologia com Consci√™ncIA gera Resultado.</p>
    </div>
    <div class="header-right">
      <img src="logo-aproveitai.png">
    </div>
  </div>
  <div class="subheader">
    üì≤ Valida√ß√£o por QR Code ‚Äî √Årea exclusiva do parceiro
  </div>
</header>

<!-- ===== MAIN ===== -->
<main>
  <div class="card">

    <button class="btn btn-camera" onclick="iniciarQR()">
      üì∑ Leitor de QR Code
    </button>

    <h2>Consulta Manual</h2>

    <div class="inputs">
      <input id="cpfInput" placeholder="CPF do cliente">
      <input id="idInput" placeholder="ID P√∫blico (APV-XXXX)">
      <button class="btn" onclick="validarCliente()">Validar Cliente</button>
    </div>

    <div id="resultado"></div>

  </div>
</main>

<!-- ===== FOOTER ===== -->
<footer>
  ¬© 2025 Cart√£o AproveitAI - PROMETHEUS EROPRO<br>
  Aviso legal: O Cart√£o AproveitAI n√£o garante descontos. Benef√≠cios e promo√ß√µes s√£o definidos exclusivamente pelos parceiros.
</footer>

<script>
/* ========= CONFIG ========= */
const API_URL = "https://script.google.com/macros/s/AKfycbzhwXhtWdsDSuABRneoz6QAD1SxpnMq3vc8e1FhtknlB7_1j6qLjYIbPA0qPJS7ck7y/exec";

/* ========= SEGURAN√áA ========= */
const parceiroLogado = JSON.parse(localStorage.getItem("parceiroLogado"));

if(!parceiroLogado || parceiroLogado.ativo !== "SIM"){
  alert("Acesso restrito. Fa√ßa login como parceiro.");
  window.location.href = "login-app.html";
}

/* ========= QR ========= */
function iniciarQR(){
  alert("Leitor de QR Code ativo.\nUse c√¢mera em ambiente HTTPS.");
}

/* ========= VALIDAR ========= */
function validarCliente(){
  const cpf = cpfInput.value.trim();
  const id  = idInput.value.trim();
  const res = document.getElementById("resultado");

  if(!cpf && !id){
    alert("Informe CPF ou ID P√∫blico");
    return;
  }

  res.style.display="block";
  res.style.background="#fff3cd";
  res.innerHTML="üîÑ Validando cliente...";

  let url = API_URL + "?acao=validar";
  if(cpf) url += "&cpf=" + encodeURIComponent(cpf);
  if(id)  url += "&idPublico=" + encodeURIComponent(id);

  fetch(url)
    .then(r=>r.json())
    .then(d=>{
      if(d.status==="ATIVO"){
        res.style.background="#d4edda";
        res.innerHTML = `
          <b style="color:green;font-size:22px">ATIVO</b><br><br>
          <b>${d.nome}</b><br>
          C√≥digo de Autoriza√ß√£o:<br>
          <b>${d.codigo}</b>
        `;
      }else{
        res.style.background="#f8d7da";
        res.innerHTML = `
          <b style="color:red;font-size:22px">INATIVO</b><br><br>
          ${d.nome || ""}
        `;
      }
    })
    .catch(()=>{
      res.style.background="#f8d7da";
      res.innerHTML="Erro ao validar cliente";
    });
}

console.log("Ambiente HTTPS ativo ‚Äî QR liberado");
</script>

</body>
</html>
