<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Relat√≥rio de Consultas</title>
<style>
  body { font-family: Arial; padding: 20px; }
  table { width: 100%; border-collapse: collapse; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background: #2e7d32; color: #fff; }
</style>
</head>
<body>
<!-- ‚úÖ CABE√áALHO PADRONIZADO -->
<header class="site-header">
  <div class="brandline">
    <img src="logo-prometheus.png" class="logo logo-prometheus">
    <div class="brand-center">
      <h1 class="site-title">Cart√£o AproveitAI</h1>
      <p class="slogan">Tecnologia com Consci√™ncIA gera Resultado.</p>

      <!-- Tarja -->
      <p class="boas-vindas">
        üè™ <strong>√Årea do Parceiro</strong><br>
        Valide clientes e acompanhe seus relat√≥rios.
      </p>
    </div>
    <img src="logo-aproveitai.png" class="logo logo-aproveitai">
  </div>
<link rel="stylesheet" href="style.css">

</header>

<h2>Relat√≥rio de Consultas ‚Äì √öltimos 7 dias</h2>
<div id="dadosParceiro" class="dados-parceiro"></div>

<button class="relatorio-botao" onclick="window.print()">
  üñ®Ô∏è Imprimir / PDF
</button>

<table>
<thead>
<tr>
  <th>Data/Hora</th>
  <th>Grupo</th>
  <th>Status</th>
  <th>C√≥digo de Autoriza√ß√£o</th>
</tr>
</thead>
<tbody id="dados"></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzhwXhtWdsDSuABRneoz6QAD1SxpnMq3vc8e1FhtknlB7_1j6qLjYIbPA0qPJS7ck7y/exec";

const parceiro = sessionStorage.getItem("parceiroNome");


if (!parceiro) {
  alert("Sess√£o expirada. Fa√ßa login novamente.");
  window.location.href = "painelparceiro.html";
}
const parceiroNome = sessionStorage.getItem("parceiroNome");
const parceiroCNPJ = sessionStorage.getItem("parceiroCNPJ");

document.getElementById("dadosParceiro").innerHTML = `
  <strong>Parceiro:</strong> ${parceiroNome || "-"}<br>
  <strong>CNPJ:</strong> ${parceiroCNPJ || "-"}
`;

fetch(API_URL + "?relatorio=1&parceiro=" + encodeURIComponent(parceiroNome))

  .then(r => r.json())
  .then(d => {
    if (!d.ok) {
      alert("Erro ao carregar relat√≥rio");
      return;
    }

    const tbody = document.getElementById("dados");
    tbody.innerHTML = "";

    d.registros.forEach(r => {
  tbody.innerHTML += `
    <tr>
      <td>${new Date(r.data).toLocaleString("pt-BR")}</td>
      <td>${r.grupo || "-"}</td>
      <td>${r.status}</td>
      <td>${r["codigo-ero"] || r.codigo_ero || "-"}</td>
    </tr>
  `;
});

  });
</script>
<!-- ‚úÖ RODAP√â PADR√ÉO -->
<footer style="
  background:#dfffe0;
  padding:10px;
  text-align:center;
  font-size:12px;
">
  ¬© 2025 Cart√£o AproveitAI ‚Ä¢ PROMETHEUS EROPRO
</footer>

</body>
</html>
