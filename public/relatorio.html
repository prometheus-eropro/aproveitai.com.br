<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Relat√≥rio de Consultas</title>
<style>
  body { font-family: Arial; padding: 20px; }
  table { width: 100%; border-collapse: collapse; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background: #2e7d32; color: #fff; }
</style>
</head>
<body>
<!-- ‚úÖ CABE√áALHO PADRONIZADO -->
<header class="site-header">
  <div class="brandline">
    <img src="logo-prometheus.png" class="logo logo-prometheus">
    <div class="brand-center">
      <h1 class="site-title">Cart√£o AproveitAI</h1>
      <p class="slogan">Tecnologia com Consci√™ncIA gera Resultado.</p>

      <!-- Tarja -->
      <p class="boas-vindas">
        üè™ <strong>√Årea do Parceiro</strong><br>
        Valide clientes e acompanhe seus relat√≥rios.
      </p>
    </div>
    <img src="logo-aproveitai.png" class="logo logo-aproveitai">
  </div>
<link rel="stylesheet" href="style.css">

</header>

<h2 id="tituloRelatorio">Relat√≥rio de Consultas</h2>
<div id="periodoRelatorio" style="
  margin:8px 0 15px 0;
  font-size:14px;
  font-weight:bold;
  color:#2e7d32;
"></div>

<div id="dadosParceiro" class="dados-parceiro"></div>


<button class="relatorio-botao" onclick="window.print()">
  üñ®Ô∏è Imprimir / PDF
</button>
<div style="text-align:center;margin:15px 0;">

  </a>
</div>


<table>
<thead>
<tr>
  <th>Data/Hora</th>
  <th>Grupo</th>
  <th>Status</th>
  <th>C√≥digo de Autoriza√ß√£o</th>
</tr>
</thead>
<tbody id="dados"></tbody>
</table>

<script>
const SESSION_KEY = "aproveitai_parceiro";

function carregarRelatorio() {
  const sessao = sessionStorage.getItem(SESSION_KEY);

  if (!sessao) {
    document.body.innerHTML = `
      <h2>‚ö† Sess√£o n√£o encontrada</h2>
      <p>Fa√ßa login novamente no painel do parceiro.</p>
      <button onclick="location.href='painelparceiro.html'">
        Ir para o Painel
      </button>
    `;
    return;
  }

  const parceiro = JSON.parse(sessao);

  document.getElementById("parceiroNome").innerText = parceiro.nome;
  document.getElementById("parceiroCnpj").innerText = parceiro.cnpj;

  fetch(API_URL + "?acao=relatorio&cnpj=" + parceiro.cnpj)
    .then(r => r.json())
    .then(d => montarTabela(d))
    .catch(() => alert("Erro ao carregar relat√≥rio"));
}

function montarTabela(dados) {
  const tbody = document.getElementById("tbodyRelatorio");
  tbody.innerHTML = "";

  dados.forEach(l => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${l.data}</td>
      <td>${l.grupo}</td>
      <td>${l.status}</td>
      <td>${l.codigo || "-"}</td>
    `;
    tbody.appendChild(tr);
  });
}

document.addEventListener("DOMContentLoaded", carregarRelatorio);
</script>

<!-- ‚úÖ RODAP√â PADR√ÉO -->
<footer style="
  background:#dfffe0;
  padding:12px;
  text-align:center;
  font-size:12px;
  line-height:1.4;
">
  ¬© 2025 Cart√£o AproveitAI ‚Ä¢ PROMETHEUS EROPRO<br>

  <strong>Aviso legal:</strong> O Cart√£o AproveitAI n√£o garante descontos.
  Benef√≠cios e promo√ß√µes s√£o definidos e concedidos exclusivamente pelos parceiros,
  v√°lidos, em regra, para pagamentos √† vista, salvo autoriza√ß√£o expressa do estabelecimento.
</footer>
</body>
</html>
