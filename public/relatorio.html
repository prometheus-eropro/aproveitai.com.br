<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Relat√≥rio de Consultas</title>
<style>
  body { font-family: Arial; padding: 20px; }
  table { width: 100%; border-collapse: collapse; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background: #2e7d32; color: #fff; }
body {
  margin: 0;
  padding: 0;
  background: #eaf6ff;
  font-family: 'Segoe UI', Arial, sans-serif;
}

.main-container {
  max-width: 420px;
  margin: 0 auto;
  padding: 12px;
}

</style>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

</head>
<body>
<!-- ‚úÖ CABE√áALHO PADRONIZADO -->
<header class="site-header">
  <div class="brandline">
    <img src="logo-prometheus.png" class="logo logo-prometheus">
    <div class="brand-center">
      <h1 class="site-title">Plataforma AproveitAI</h1>
      <p class="slogan">Tecnologia com Consci√™ncIA gera Resultado.</p>

      <!-- Tarja -->
      <p class="boas-vindas">
        üè™ <strong>√Årea do Parceiro</strong><br>
        Valide clientes e acompanhe seus relat√≥rios.
      </p>
    </div>
    <img src="logo-aproveitai.png" class="logo logo-aproveitai">
  </div>
<link rel="stylesheet" href="style.css">

</header>

<h2 id="tituloRelatorio">Relat√≥rio de Consultas</h2>
<div id="periodoRelatorio" style="
  margin:8px 0 15px 0;
  font-size:14px;
  font-weight:bold;
  color:#2e7d32;
"></div>

<div id="dadosParceiro" class="dados-parceiro"></div>


<button class="relatorio-botao" onclick="window.print()">
  üñ®Ô∏è Imprimir / PDF
</button>
<div style="text-align:center;margin:15px 0;">

  </a>
</div>


<table>
<thead>
<tr>
  <th>Data/Hora</th>
  <th>Grupo</th>
  <th>Status</th>
  <th>C√≥digo de Autoriza√ß√£o</th>
</tr>
</thead>
<tbody id="dados"></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzhwXhtWdsDSuABRneoz6QAD1SxpnMq3vc8e1FhtknlB7_1j6qLjYIbPA0qPJS7ck7y/exec";
const parceiroNome = sessionStorage.getItem("parceiroNome");
const parceiroCNPJ = sessionStorage.getItem("parceiroCNPJ");

if (!parceiroNome || !parceiroCNPJ) {
  document.body.innerHTML = `
    <div style="padding:40px;text-align:center">
      <h2>‚ö†Ô∏è Sess√£o n√£o encontrada</h2>
      <p>Volte ao painel do parceiro para acessar o relat√≥rio.</p>
      <button onclick="window.location.href='painelparceiro.html'">
        üîê Ir para Login
      </button>
    </div>
  `;
  throw new Error("Sess√£o ausente");
}

document.getElementById("dadosParceiro").innerHTML = `
  <strong>Parceiro:</strong> ${parceiroNome || "-"}<br>
  <strong>CNPJ:</strong> ${parceiroCNPJ || "-"}
`;

fetch(API_URL + "?relatorio=1&parceiro=" + encodeURIComponent(parceiroNome))

  .then(r => r.json())
  .then(d => {
    if (!d.ok) {
      alert("Erro ao carregar relat√≥rio");
      return;
    }
// üëâ Exibir per√≠odo do relat√≥rio (se vier do GS)
if (d.periodo && d.periodo.inicio && d.periodo.fim) {
  const ini = new Date(d.periodo.inicio).toLocaleDateString("pt-BR");
  const fim = new Date(d.periodo.fim).toLocaleDateString("pt-BR");

  document.getElementById("periodoRelatorio").innerText =
    `Relat√≥rio de ${ini} a ${fim}`;
} else {
  document.getElementById("periodoRelatorio").innerText =
    "Relat√≥rio padr√£o (√∫ltimos registros)";
}

    const tbody = document.getElementById("dados");
    tbody.innerHTML = "";

    d.dados.forEach(r => {
  tbody.innerHTML += `
    <tr>
      <td>${new Date(r.data).toLocaleString("pt-BR")}</td>
      <td>${r.grupo || "-"}</td>
      <td>${r.status}</td>
      <td>${r["codigo-ero"] || r.codigo_ero || "-"}</td>
    </tr>
  `;
});

  });
function voltarPainel() {
  window.location.href = "painelparceiro.html";
}

</script>
<div style="margin:20px;text-align:center">
  <button onclick="history.back()">
    ‚¨ÖÔ∏è Voltar
  </button>
</div>

<!-- ‚úÖ RODAP√â PADR√ÉO -->
<footer style="
  background:#dfffe0;
  padding:12px;
  text-align:center;
  font-size:12px;
  line-height:1.4;
">
  ¬© 2025 Plataforma AproveitAI ‚Ä¢ PROMETHEUS EROPRO<br>

  <strong>Aviso legal:</strong> A Plataforma AproveitAI n√£o garante descontos.
  Benef√≠cios e promo√ß√µes s√£o definidos e concedidos exclusivamente pelos parceiros,
  v√°lidos, em regra, para pagamentos √† vista em moeda corrente, salvo autoriza√ß√£o expressa do estabelecimento.
</footer>

</body>
</html>
