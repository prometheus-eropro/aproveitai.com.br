<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Valida√ß√£o por QR Code ‚Ä¢ AproveitAI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="style.css">

<style>
body{
  margin:0;
  background:#f4f6f6;
  font-family: Arial, sans-serif;
}

main{
  min-height: calc(100vh - 240px);
  display:flex;
  justify-content:center;
  align-items:center;
}

#scanner{
  width:100%;
  max-width:420px;
  background:#fff;
  padding:20px;
  border-radius:14px;
  box-shadow:0 4px 12px rgba(0,0,0,.15);
  text-align:center;
}

#status{
  margin-top:15px;
  font-weight:bold;
}
</style>
</head>

<body>

<!-- CABE√áALHO PADR√ÉO -->
<header class="site-header">
  <div class="brandline">
    <img src="logo-prometheus.png" class="logo logo-prometheus">

    <div class="brand-center">
      <h1 class="site-title">Cart√£o AproveitAI</h1>
      <p class="slogan">Tecnologia com Consci√™ncIA gera Resultado.</p>

      <!-- TARJA VERDE -->
      <div class="tarja-verde">
        üì∑ Validador de QR Code
      </div>
    </div>

    <img src="logo-aproveitai.png" class="logo logo-aproveitai">
  </div>
</header>

<main>
  <div id="scanner">
    <h3>üì∑ Aponte para o QR Code do cliente</h3>
    <div id="reader"></div>
    <div id="status">Inicializando c√¢mera‚Ä¶</div>
  </div>
</main>

<!-- RODAP√â -->
<footer class="footer">
  <div class="footer-container">
    <div>
      <b>Cart√£o AproveitAI</b><br>
      PROMETHEUS EROPRO Solu√ß√µes Inteligentes LTDA<br>
      CNPJ: 58.584.332/0001-40
    </div>
    <div>
      <a href="index.html">Voltar ao site</a>
    </div>
  </div>
  <div class="footer-bottom">
    ¬© 2025 AproveitAI
  </div>
</footer>
<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzhwXhtWdsDSuABRneoz6QAD1SxpnMq3vc8e1FhtknlB7_1j6qLjYIbPA0qPJS7ck7y/exec";
<script>
// ===============================
// BLOQUEIO DE ACESSO
// ===============================
const parceiroLogado = sessionStorage.getItem("parceiroLogado");
const parceiroNome = sessionStorage.getItem("parceiroNome");
const parceiroCnpj = sessionStorage.getItem("parceiroCnpj");

if (parceiroLogado !== "SIM") {
  document.body.innerHTML = `
    <div style="text-align:center; padding:40px">
      <h2>‚ö†Ô∏è Acesso restrito</h2>
      <p>Este validador s√≥ pode ser acessado pela √Årea do Parceiro.</p>
      <a href="painelparceiro.html">Ir para √Årea do Parceiro</a>
    </div>
  `;
  throw new Error("Parceiro n√£o logado");
}
</script>

/* üîê BLOQUEIO: s√≥ entra se veio do painel */
const parceiroNome = sessionStorage.getItem("parceiroNome");

if (!parceiroNome) {
  document.body.innerHTML = `
    <div style="padding:50px;text-align:center;font-family:Arial">
      <h2>‚ö†Ô∏è Acesso restrito</h2>
      <p>Este validador s√≥ pode ser acessado pela √Årea do Parceiro.</p>
      <a href="painelparceiro.html">üëâ Ir para √Årea do Parceiro</a>
    </div>
  `;
  throw new Error("Parceiro n√£o logado");
}

/* JSONP helper */
function jsonp(url) {
  return new Promise((resolve, reject) => {
    const cb = "cb_" + Date.now();
    window[cb] = data => {
      resolve(data);
      delete window[cb];
      script.remove();
    };
    const script = document.createElement("script");
    script.src = url + (url.includes("?") ? "&" : "?") + "callback=" + cb;
    script.onerror = reject;
    document.body.appendChild(script);
  });
}

/* üì∑ QR CODE */
function onScanSuccess(decodedText) {
/* Inicializa c√¢mera */
const html5QrCode = new Html5Qrcode("reader");
Html5Qrcode.getCameras().then(cameras => {
  if (cameras.length) {
    html5QrCode.start(
      cameras[0].id,
      { fps: 10, qrbox: 250 },
      onScanSuccess
    );
  }
});
</script>


</body>
</html>
